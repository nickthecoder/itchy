Current Tasks
=============

Duplicate scene

Implement change Layout in scene designer.
    Rename a Layer needs to update all scenes (just like renaming a costume, but the owner needs to be the Layout).



Make some gates need balloons 2, rocks 2, instead of 3, 3?
    Or make a new balloons3?

Look over all TODOs


Debris-rocks - pieces have offsets, so they explode naturally.
    Can I use Fragments class as this already does what I want?
    Make Fragments an abstract base class, then implement :
        RandomFragments - (What Fragments currently does)
        FloodFillFragments - Flood fill based on transparency for the keyboard and "K"
        ColorKeyFragments - for the others Pyrox rocks, or maybe Random with a fixed key (to ensure pieces are not too small).
    Replace naff rocks
    Get rotation and speed right, so the game is more playable. 

BUGS
====


New Features
============


Client/Server views.
--------------------

    Does it matter that the client is having to redraw all rotated images every time
        (because Appearance cannot cache the results if only one client actor is used).

    Makeup not being sent.
        Should I attempt to cache makeup data on the client?

    Escape strings
        If using lines for each command, need to escape strings using: \n (newline) , \; (for a comma)  , \\ (slash)
    
    Send a protocol version number, and moan if the client and server are different
    
    Send data via special data classes.
        Base class just has a String "command".
        Or have a class for each message type.
        Use Properties to automate the encode/decode.

    Clients sends a list of events (keyboard, mouse)

    Dynamics poses are an issue. Solutions:
        disallow them completely (Limiting)
        allow them to be sent ONCE at the beginning of the session (Needs extra code, but is possible).
        send them when needed - frames would stutter.
        allow code to generate them within the clients (Bad idea).
        
        Note. Pose PoseResource may need to be refactored again so that ALL poses have a name, and are in Resources.

    This can let anybody play any game remotely just by downloading the resources. No game code needs to run on
    their machine! Cool.
        Resources could be automatically downloaded, and for bonus points, do this using bittorrent technology.
    
    ClientSetup
        Add an option to download the resources from the server. Put in a "downloads" directory, rather than "resources".
        Don't download scripts, scenes or macros, only images, fonts, sounds and the itchy file.
            *.txt (for licenses), *.itchy, *.png, *.bmp, *.ttf, *.otf??, *.wav, *.ogg?
        Use a separate port, and use like a web server (maybe use an embedded web server?)
    
    Sounds are currently all owned by a single actor. Therefore they won't behave quite the same.



Convolution matrix using images as the matrix.
    Assume 8bbp RGBA in any order (but the same order for the convolution matrix and the source image).
    Loop over each pixel in the image
        Loop over each pixel in the matrix. Multiply together, and accumulate into a total.
            Divide by sum of the convolution matrix
            Store in the destination.
    Edges.
        Extend the edges outwards, so there are no special cases
        Or, specify a 'Background' colour for outside the image.
        Or Crop
NinePatches in SpriteSheet
    Use it on the defaultGUI resources.
    Implement by allowing a Pose or a Filename for a NinePatch ?
    Or allow nine patches within sprite sheets?


Undo/Redo for Z Order Reset
    Create a "Group" undo/redo, and add each zorder change to that group.
    Undo/redo the group as one.

Undo/Redo for destructive edits, such as changing class names (e.g. Makeup)

SceneDesigner: one dotted box for the screen's  bounds, and another for the current view's if they are different.
    Make both semi-transparent?

Ensure Scrollbars of Scroll do not obscure the contents?

Cover-of-Darkness Menu : A street - you are driving the van. Park outside a house to start the level.
    Streets with lights on are "locked"


Editor to test if resources have changed and prompt for confirm before exiting.


Animations to apply start/end events, so that sounds can be played.
	Can also be used to assign a new Pose during a non-framed based animation.


Have a preview image of the animation in FramedAnimationEditor.
	Single step back/forward or continuous.
	In fact, don't have the list or poses, just show one frame's details, and scroll back/forward to edit others.

Redesign editor based on a traditional IDE style layout.
    Left panel contains tree structure of all objects (Poses/Animations/Inputs/Costumes/Scenes etc)
        Can subset the list for a single type (e.g. just Poses)
        Hide those views if there are no children
    Central "Edit" panel will display the currently selected object (pose/animation etc).
    "Pin" any view to add it as a tab, otherwise it vanishes when another view is selected.
        Save "pinned" views as Preferences, so they are visible after restarting the editor.
    Can be editing multiple items simultaneously, each with its own tab.
        This will have impact on renamed poses etc. Maybe very tricky!
        Maybe abandon Ok/Cancel, and always auto-update.
        Notepad will need "<" and ">" navigation items, when tabs cannot all fit.
    Left panel can also have a "favourites" view and a "Recent" view.
    Toolbar items for Add Pose/Sprite Sheet/Animation/Sound/Input etc.
    SceneDesigner to co-exist, just like any SubEditor.
        The actors in a scene are also listed in the main tree view.
            Shortcut for toolbox pages automatically shows the toolbox.
        Toolbox not free floating
            Either hidden (when not in scene designer), or taking up full width at bottom of screen.
    Toolbox and Side Panel can be hidden/shown via a toggle button in the toolbar (and shortcut).
        Toolbar is always visible
        Toolbar changes depending on what is being edited.
    Still have the Tables (when a category is selected)?


Nice-to-have Features
=====================



Use Scroll for TextArea, instead of its buggy, self implemented, non-clipping scroller.
    Clip the TextBox input too.

Be able to select text in EntryBoxes, and copy/cut/delete the selected text.
    Double click to select a word.

Spritesheet : Crop. Remove all transparent edges, updating the x,y offsets appropriately.
    Use this on the mings spritesheet.

ColorKeyFragment. Use another pose, to decide which pixels belong to each fragment.
    If the poses aren't the same size, then scale non blended.


Code Tidy Up
============

Never adjust the mouse event.x,y. Instead, pass a Point (or x,y), which is relative to the object in question.
    Make the API clear, and there's no confusion about what the event's x,y values mean (they are always absolute screen).
    Add the additional parameters to the relevant methods
    Rename the methods onMouseXXXRelative
    There should not be mouseMove methods, only onMouseMove and onMouseMoveRelative

Remove deprecate Resources.getCompanionCostume.

Scrap the concept of views within views?
    Just have lists of views, all are relative to the screen. Makes it MUCH simpler!
    Need to look at Window/RootContainer first.
    Also need to consider ZOrder of views.
        Perhaps keep the hierarchy of views for the z-order, but make each view relative to the screen, not the parent view.

Load/Save using properties wherever possible.
   

MouseListenerView - Why is Game passed to its methods?

Look at ScriptManager's createXXX methods, and see where they are called from.
    Consider removing createXXX methods, and doing it via ClassName.createInstance instead.

Pixelator has a bodge in it. Sometime it needs to add one to all the pixels.
	Do a test, and see if the top row of pixels are blank for large scales, and if so,
		then move blit to another surface before embossing the edges.
	Rename it EmbossEdgesPixelator? Create EmbossPixelator, which embosses every pixel.

WTF is Animation.startExceptFirst ? Parallel certainly doesn't do anything sensible!
	Used when merging two animations. Do it better!!!

Move GraphicsContext to the gui package? Is it used elsewhere (for stages?)

Pyrox : gridRole.onBirth looks like rubbish. Is it called?
Pyrox : gridRole.talk looks weird.

Look at companion, it has font, font size and color. Why ????
    Check sub classes for get/set for font colour size etc. I think this is done now???
    Check sub classes for margins???

Talk and TalkProjectile
    Talk doesn't have "fade", which is the only reason that Gate uses TalkProjectile (it doesn't move!!!)
    Should talk use animations to fade and die or a constant, hard-wired fade?
    Do we need Talk.stop now that we have TalkProjectile? It was originally there, so that it wouldn't follow!

    Zoom in/out : Scale all GridRole objects. Care needed if/when creating new objects.

Should TextPose have a TextStyle, rather than individual attributes?

Why have a Role interface if everything will end up using AbstractRole?
    Why does Role have "birth" and yet everything uses onBirth() ? Ditto with other events.
    At least make Role have the methods that people will actually use ie. onBirth rather than birth.

Disallow roles being removed and added to an actor. An actor has a role for life.
    If you need to change behaviour, do it like the Mings do it, and have a separate class hierarchy. 
    Hmm, Pause does exactly that!
        Probably a bad design, as the user's roles may do some of their own stuff in onActive, and
        not expect it to be called when unpaused.
    Delayed Activation also works like this!

Rox Ideas
=========
    Have a music layer, which has notes at each point. When an object moves over it, call that note's event to play the note.
        When a player stays one square, continue to play the square's note(s)
            The player has events, and the squares have event names. Use animations to control the sequence of notes played?
                Use the player's animations, but animate the Note object so that it doesn't interfere with the player's normal animation.
        Can have a high tempo piece whenever you hover on a "dangerous" or important square.
        Different characters will play different samples (but of the same basic note).
        The "correct" way through the puzzle should always sound harmonious
        Have set riffs, which can be played in different keys.
            While moving across a same-key field, it will sound like "Bah-Bah-Bah-Bah" for each square walked.
            Then when you stand still, the riff continues "Bah-da-da-da-Bah-da-da".
        Some square are silent.
        The square knows the name of the note, but the level know the instrument to use. The sample to use if "$instrument-$note".
        Some music squares can change the instrument too. From and To at choke points
        Use the editor's strings to define the riffs??
        Would be nice to have a visual representation of the music squares values.
            Use Makeup to achieve this?
            Can use colour to denote the note - hue for A-G and saturation/brightness for the octave. Background pattern for the instrument.
        Put the music in the grid at the same time as the GridRoles.
        Use classic songs for some obvious-ish pathways.


Other Stuff
===========

SDL Drop event to add poses by dragging image files.

SceneDesigner for Text
    Don't have a "Text" tool??
    The thumbnail should have the font-size in the bottom right if its bigger than the thumbnail can display.
        Using an Editor's font, because we want a plain, consistent font.
    When saving an actor, only save the attributes which differ from the costume's style.
    Have a "Reset to Costume Defaults", and a "Apply to Costume" buttons.

Group Costumes on the SceneDesigner's toolbox, so that similar costumes can be displayed as a single item.
    Clicking it reveals a popup, where the actual Costume can be selected.
    Use this for Pyrox's machines, one way streets.
        A costume can have a "Group Leader" field, which is the name of the Costume that is displayed as the
        main icon in the scene design toolbox. Similar impl as "costume base"
    Instead of a Popup, when the group leader is clicked, reveal the "children". Click to hide them. Leader will be there twice???
        If costume has a "leader" pose, then use that instead of default.

SceneDesigner : select groups of actors, and move/delete them together.

Create a Background interface :
    NoBackground, RGBABackground
    Tile, BrickH, BrickV, TileH, TileV (spacing can be different to the image size)
    We already have Renderable, which can do nine-patches and flat colour.
    Should the background be scrollable?

Explosion and Projectile don't work very well with text - See Gate.collected.

Should Costumes have Makeup? If each jewel is given a Sparkle makeup, does it make sense to apply it to every jewel in the scene?
    No. A diamond costume would specify a standard makeup, which can be overridden if needed.
    Have a reset button to revert to the costume's makeup, or default makeup if it has none.
    Costumes' makeup just like animations - based on events, and can have multiple options picked a random.
	One Makeup shared by many costumes, so it has its own tab, just like animation. 

GUIView.keyUp does nothing - is this ok?

Later
=====

Use JBox2D : http://www.jbox2d.org/

Joystick input devices.

BlitModes on Pose, so a "spotlight" can ADD

"Duplicate" button in Animation editor - maybe on Costume too.

Drag and drop to move and reorder animation in the editor.
    Replace the whole AnimationEditor with a timeline, where sequence are arranged left to right and parallel are stacked top to bottom.
    Test and edit are done in the same full screen editor - like scene designer.
    Add: Pick a pose, then place it on the world.
    A large time-line pane shows an overview of the animation. Dragging controls will change the tick or loops of the animation.
        Can fill the whole page, with the animation on top of it.
    Click at a point in the time-line to show that frame.
    Save the pose and start x,y, direction, heading with each animation ("test" tag)


Much Later
==========

Simple convolution filter
    Filters don't need to be square.
    Create empty space around the image. Later give option of duping the image's edge.
    Apply the convolution matrix.
        For RGB, just apply the matrix to each channel in turn.
        For RGBA we'd need to change the final DIVIDE to discount transparent pixels. i.e divide by sum of matrix * alphas.
        Apply the matrix to alpha as normal.

   Many things just need the alpha channel convolved?

Look at rotozoom, and try to implement a generic affine transformation matrix???
    Calc size of dest
    Calc pos of corners
    Bresinem walk from translated top left to bottom left.
        Bres walk across the "row"
        Copy pixel.
    That only leaves the problem of blending.
        Instead of choosing one src pixel, we consider the rectangle from the source
            Where the rect is large, average multiple pixels
            Where the rect is small (less than 2x2 pixels), average parts of each pixel.

Same pattern for sounds and animations, not for font or nine patches.


How about a Scripts tab
    List all scripts double click to edit.
    Show errors / Clear errors

Get Thrust to run via "launch" without the resource symlinks to itchy.
    Need thrust's jar file to be in a lib directory within its resources, and for the jar to be loaded
    after java has started.

iThrust
	Bucket to be more transparent
	Water looks naff

Component : Override all rules. Currently only Font can be overridden.
    Allow to be reset to default (i.e. be restyled).

Create a game which uses the GUI

Create a game using an isometric view, where Z-Order is governed by actor's Y value.
    







